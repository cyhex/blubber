<!DOCTYPE html>
<html>
<head lang="en">
<title>Child app</title>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../../css/bootstrap.min.css">
<link rel="stylesheet" href="../../css/main.css">
</head>
<body>
    <div class="container">

        <div class="panel panel-default panel-info">
            <div class="panel-heading">Confirm Payment</div>
            <div class="panel-body">
                <form method="get" action="/api/pay">
                    <div id="paymentData" class="container"></div>

                    <div class="btn-group">
                        <a class="btn btn-default" href="index.html">Cancel</a>
                        <button class="btn btn-info" type="submit">Confirm Payment</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <script type="text/template" id="tempalte">
        <% if(imgurl) {%>
        <div class="row text-center">
            <img src="<%= imgurl %>">
        </div>
        <%  } %>
        <div class="row">
            <div class="col-xs-6"><b>Product name</b></div>
            <div class="col-xs-6"> <%= name.replace(/\+/g,' ')%></div>
            <input type="hidden" name="name" value="<%= name.replace(/\+/g,' ')%>">
        </div>

        <div class="row">
            <div class="col-xs-6"><b>Unit price</b></div>
            <div class="col-xs-6"> <%=unit_price%></div>
            <input type="hidden" name="unit_price" value="<%=unit_price%>">
        </div>

        <div class="row">
            <div class="col-xs-6"><b>Unit count</b></div>
            <div class="col-xs-6"> <%=unit_count%></div>
            <input type="hidden" name="unit_count" value="<%=unit_count%>">
        </div>

        <div class="row form-group">
            <div class="col-xs-6"><b>Recipient</b></div>
            <div class="col-xs-6"> <%=recipient%></div>
            <input type="hidden" name="recipient" value="<%=recipient%>">
        </div>

    </script>

    <script src="../../js/jquery-2.1.1.min.js"></script>
    <script src="../../js/underscore-min.js"></script>
    <script src="../../js/main.js"></script>

    <script>
        $(document).ready(function () {
            var template = _.template($("#tempalte").html());
            var query = Helpers.parseQuery(window.location.search.substring(1));
            var data = Helpers.parseQuery(decodeURIComponent(decodeURIComponent(query.code)));
            $("#paymentData").html(template(data));
        });
    </script>
</body>
</html>